<div class="container">
  <!-- Header Card -->
  <!-- <mat-card class="header-card">
    
  </mat-card> -->
   <div class="header-content">
    <mat-card-header>
      <mat-card-title>
        <mat-icon class="title-icon">account_tree</mat-icon>
        <span *ngIf="processName">{{ processName }}</span>
        <span *ngIf="!processName">Process Diagram</span>
      </mat-card-title>
      <mat-card-subtitle *ngIf="processId">
        Process ID: <code class="process-id">{{ processId }}</code>
      </mat-card-subtitle>
      <mat-card-subtitle *ngIf="!processId">
        No process loaded
      </mat-card-subtitle>
    </mat-card-header>

    <div class="spacer"></div>
    
    <div class="action-buttons">
      <button mat-raised-button (click)="resetDiagram()" [disabled]="deploying">
          <mat-icon>refresh</mat-icon>
          Reset
        </button>
        <button mat-raised-button color="primary" (click)="exportDiagram()" [disabled]="deploying">
          <mat-icon>save</mat-icon>
          Save XML
        </button>
        <button mat-raised-button color="accent" (click)="showTaskFormHelp()" [disabled]="deploying"
                matTooltip="How to open task forms">
          <mat-icon>assignment</mat-icon>
          Task Forms
        </button>
        <button mat-raised-button color="warn" (click)="deployDiagram()" [disabled]="deploying">
          <mat-spinner diameter="20" *ngIf="deploying"></mat-spinner>
          <mat-icon *ngIf="!deploying">rocket_launch</mat-icon>
          {{ deploying ? 'Deploying...' : 'Deploy to Server' }}
        </button>
        <button *ngIf="processId" mat-raised-button (click)="loadProcessDiagram(processId)" [disabled]="deploying">
          <mat-icon>cloud_download</mat-icon>
          Reload from Server
        </button>
    </div>
   </div>

  


  <!-- Loading State -->
  <mat-card *ngIf="loading" class="loading-card">
    <mat-card-content class="loading-content">
      <mat-spinner diameter="40"></mat-spinner>
      <p>Loading process diagram...</p>
    </mat-card-content>
  </mat-card>

  <!-- Error State -->
  <mat-card *ngIf="error && !loading" class="error-card">
    <mat-card-content class="error-content">
      <div class="error-message">
        <mat-icon class="error-icon">warning</mat-icon>
        {{ error }}
      </div>
      <button mat-raised-button color="primary" (click)="loadProcessDiagram(processId!)">
        <mat-icon>refresh</mat-icon>
        Retry
      </button>
    </mat-card-content>
  </mat-card>

  <!-- Main BPMN Container -->
  <div class="main-container" [class.hidden]="loading">
    <mat-card class="diagram-card">
      <div #diagramRef class="diagram-container"></div>
    </mat-card>

    <mat-card class="properties-card" [class.collapsed]="propertiesCollapsed">
      <!-- <mat-card-header class="properties-header">
        <mat-card-title>
          Properties Panel
        </mat-card-title>
        <button mat-icon-button
                (click)="toggleProperties()"
                [title]="propertiesCollapsed ? 'Expand Properties' : 'Collapse Properties'"
                class="toggle-button">
          <mat-icon>{{ propertiesCollapsed ? 'chevron_left' : 'chevron_right' }}</mat-icon>
        </button>
      </mat-card-header> -->
      <mat-card-content class="properties-content" [class.hidden]="propertiesCollapsed">
        <div #propertiesRef></div>
      </mat-card-content>
    </mat-card>
  </div>
</div>
